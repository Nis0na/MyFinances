{% load feature_enabled %}
{% feature_enabled "isInvoiceSchedulingEnabled" as schedule_invoices_enabled %}
<div data-oob="await_schedule_update_refresh"></div>
<div class="card p-6 shadow-xl bg-base-100 mb-4">
    <div class=" text-3xl w-full grid grid-cols-4">
        <div hx-boost="true">
            <a href="{% url 'invoices:single:dashboard' %}"
               class="btn btn-sm btn-outline btn-secondary me-3 float-left">Back to list</a>
        </div>
        <h1 class="text-center col-span-2">Invoice Set #{{ invoiceSet.id }}</h1>
        <div>
            <button hx-delete="{% url 'api:invoices:single:delete' %}"
                    hx-swap="none"
                    hx-confirm="Are you sure you would like to delete invoice #{{ invoiceSet.id }}?"
                    hx-vals='{"invoice": "{{ invoiceSet.id }}", "redirect": "/dashboard/invoices/"}'
                    class="btn btn-sm btn-outline btn-error me-3 float-right">
                <i class="fa-solid fa-trash"></i>
                Delete
            </button>
        </div>
    </div>
</div>
<div class="card bg-base-100 shadow-xl w-full p-6 flex-col gap-y-4">
    <div class="flex flex-wrap gap-y-4">
        <a href="{% url 'invoices:single:edit' invoice_id=invoiceSet.id %}"
           class="btn btn-md btn-outline btn-default grow mr-4 btn-disabled">
            <i class="fa-solid fa-edit"></i>
            Edit Set
        </a>
        <a href="{% url 'invoices:single:edit' invoice_id=invoiceSet.id %}"
           class="btn btn-md btn-outline btn-default grow mr-4 btn-disabled">
            <i class="fa-solid fa-clone"></i>
            Clone Set
        </a>
    </div>
    <div class="mt-2">
        <div class="flex items-center space-x-2">
            <!-- Icon and Text for Current Status -->
            <div data-oob="status">
                {% include "pages/invoices/recurring/dashboard/_status_badge.html" with status=invoiceSet.status inv_id=invoice_id design="default" %}
            </div>
            <!-- Mark As Button -->
            <div class="dropdown dropdown-right dropdown-hover">
                <div class="m-1 btn btn-primary" tabindex="0" role="button">
                    <i class="fa-solid fa-flag"></i>
                    Mark As
                </div>
                <ul tabindex="0"
                    class="p-2 shadow menu dropdown-content z-[1] bg-base-100 rounded-box w-52">
                    <li>
                        <button hx-swap="none"
                                hx-post="{% url "api:invoices:single:edit status" invoice_id=invoiceSet.id status='pending' %}">
                            <i class="fa-solid fa-hourglass-half"></i>
                            Pending
                        </button>
                    </li>
                    <li>
                        <button hx-swap="none"
                                hx-post="{% url "api:invoices:single:edit status" invoice_id=invoiceSet.id status='paid' %}">
                            <i class="fa-solid fa-circle-check"></i>
                            Paid
                        </button>
                    </li>
                    <li>
                        <button hx-swap="none"
                                hx-post="{% url "api:invoices:single:edit status" invoice_id=invoiceSet.id status='overdue' %}">
                            <i class="fa-solid fa-exclamation-triangle"></i>
                            Overdue
                        </button>
                    </li>
                </ul>
            </div>
            <button class="btn btn-outline btn-secondary btn-disabled"
                hx-trigger="click once"
                hx-swap="beforeend"
                hx-target="#modal_container"
                {#                    _="on click call modal_invoices_edit_discount.showModal()"#}
                {#                    hx-get="{% url "api:base:modal retrieve with context" context_type="invoice" context_value=invoiceSet.id modal_name="invoices_edit_discount" %}">#}
                >
                <i class="fa fa-solid fa-pound-sign mr-2"></i>
                Edit Discount
            </button>
            <div data-oob="pause_refresh_button">
                {% include "pages/invoices/recurring/dashboard/_pause_button.html" %}
            </div>
            <button class="btn btn-outline"
                    hx-swap="none"
                    data-tip="Something went wrong with the schedule. Refresh its status"
                    hx-post="{% url "api:invoices:recurring:edit status" invoice_set_id=invoiceSet.id status='refresh' %}">
                <i class="fa-solid fa-refresh"></i>
                Refresh Schedule status
            </button>
        </div>
    </div>
</div>
{#    <div class="collapse collapse-arrow card bg-base-100 shadow-xl w-full p-6 flex-row gap-x-4 mt-4">#}
{#        <input type="checkbox" checked />#}
{#        <div class="collapse-title text-xl font-medium">Manage Invoice Content</div>#}
{#        <div id="container" class="collapse-content"></div>#}
{#    </div>#}
